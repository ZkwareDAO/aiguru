# Phase 2 å®æ–½æ–¹æ¡ˆæ€»ç»“

**åˆ¶å®šæ—¥æœŸ**: 2025-10-05  
**çŠ¶æ€**: ğŸ“‹ è®¡åˆ’å®Œæˆï¼Œå¾…æ‚¨ç¡®è®¤å¼€å§‹å®æ–½  

---

## ğŸ¯ Phase 2 è¦åšä»€ä¹ˆï¼Ÿ

### ä¸€å¥è¯æ€»ç»“
**å°†Phase 1å¼€å‘çš„Agentæ‰¹æ”¹ç³»ç»Ÿé›†æˆåˆ°å®é™…åº”ç”¨ä¸­ï¼Œè®©ç”¨æˆ·å¯ä»¥é€šè¿‡å‰ç«¯ç•Œé¢ä½¿ç”¨AIæ‰¹æ”¹åŠŸèƒ½ã€‚**

### æ ¸å¿ƒä»»åŠ¡
1. **åç«¯é›†æˆ** - æ•°æ®åº“ã€WebSocketã€APIå®Œå–„
2. **å‰ç«¯å¼€å‘** - 4ä¸ªç”¨æˆ·ç•Œé¢é¡µé¢
3. **å®æ—¶åé¦ˆ** - æ‰¹æ”¹è¿›åº¦å®æ—¶æ˜¾ç¤º
4. **å®Œæ•´æµ‹è¯•** - ç«¯åˆ°ç«¯åŠŸèƒ½éªŒè¯
5. **ç”¨æˆ·ä½“éªŒ** - æµç•…çš„äº¤äº’ä½“éªŒ

---

## ğŸ”§ Phase 2 æ€ä¹ˆåšï¼Ÿ

### æ•´ä½“ç­–ç•¥
åˆ†**ä¸¤å‘¨**å®Œæˆï¼Œ**å‰åç«¯å¹¶è¡Œ**å¼€å‘ï¼š

#### Week 1: åç«¯å®Œå–„ (5å¤©)
```
Day 1-2: æ•°æ®åº“é›†æˆ
  â”œâ”€ æ·»åŠ Agentæ‰¹æ”¹å­—æ®µåˆ°Submissionæ¨¡å‹
  â”œâ”€ åˆ›å»ºæ•°æ®åº“è¿ç§»
  â”œâ”€ åˆ›å»ºå­˜å‚¨æœåŠ¡
  â””â”€ æµ‹è¯•æ•°æ®è¯»å†™

Day 3-4: WebSocketå®æ—¶é€šçŸ¥
  â”œâ”€ å®šä¹‰è¿›åº¦äº‹ä»¶
  â”œâ”€ ä¿®æ”¹Agentç¼–æ’å™¨æ·»åŠ è¿›åº¦å›è°ƒ
  â”œâ”€ æ›´æ–°APIé›†æˆWebSocket
  â””â”€ æµ‹è¯•å®æ—¶æ¨é€

Day 5: APIå®Œå–„
  â”œâ”€ å®Œå–„æ‰€æœ‰ç«¯ç‚¹
  â”œâ”€ æ·»åŠ é”™è¯¯å¤„ç†
  â””â”€ ç”ŸæˆAPIæ–‡æ¡£
```

#### Week 2: å‰ç«¯å¼€å‘ (5å¤©)
```
Day 6-7: é¡µé¢å¼€å‘
  â”œâ”€ ä½œä¸šæäº¤é¡µé¢ (æ–‡ä»¶ä¸Šä¼ )
  â”œâ”€ æ‰¹æ”¹è¿›åº¦é¡µé¢ (å®æ—¶è¿›åº¦æ¡)
  â”œâ”€ æ‰¹æ”¹ç»“æœé¡µé¢ (åˆ†æ•°ã€é”™è¯¯ã€åé¦ˆ)
  â””â”€ å†å²è®°å½•é¡µé¢ (æäº¤åˆ—è¡¨)

Day 8: APIé›†æˆ
  â”œâ”€ åˆ›å»ºAPIå®¢æˆ·ç«¯
  â”œâ”€ React Query hooks
  â”œâ”€ WebSocketé›†æˆ
  â””â”€ é”™è¯¯å¤„ç†

Day 9: ç«¯åˆ°ç«¯æµ‹è¯•
  â”œâ”€ æ‰‹åŠ¨æµ‹è¯•å®Œæ•´æµç¨‹
  â”œâ”€ è‡ªåŠ¨åŒ–æµ‹è¯•
  â””â”€ æ€§èƒ½æµ‹è¯•

Day 10: ä¼˜åŒ–éƒ¨ç½²
  â”œâ”€ UI/UXä¼˜åŒ–
  â”œâ”€ æ€§èƒ½ä¼˜åŒ–
  â”œâ”€ æ–‡æ¡£å®Œå–„
  â””â”€ éƒ¨ç½²å‡†å¤‡
```

---

## ğŸ“Š ç”¨æˆ·ä½¿ç”¨æµç¨‹

### å®Œæ•´æµç¨‹
```
1. ç”¨æˆ·ç™»å½•ç³»ç»Ÿ
   â†“
2. é€‰æ‹©ä½œä¸š
   â†“
3. ä¸Šä¼ æ–‡ä»¶ (PDF/å›¾ç‰‡/æ–‡æœ¬)
   â†“
4. ç‚¹å‡»"æäº¤å¹¶æ‰¹æ”¹"
   â†“
5. è·³è½¬åˆ°è¿›åº¦é¡µé¢
   â”œâ”€ æ˜¾ç¤ºè¿›åº¦æ¡ (0-100%)
   â”œâ”€ æ˜¾ç¤ºå½“å‰çŠ¶æ€ (é¢„å¤„ç†/æ‰¹æ”¹ä¸­/å®Œæˆ)
   â””â”€ å®æ—¶æ›´æ–° (WebSocket)
   â†“
6. æ‰¹æ”¹å®Œæˆåè‡ªåŠ¨è·³è½¬
   â†“
7. æŸ¥çœ‹æ‰¹æ”¹ç»“æœ
   â”œâ”€ åˆ†æ•°å’Œç½®ä¿¡åº¦
   â”œâ”€ é”™è¯¯åˆ—è¡¨ (ä½ç½®ã€è¯´æ˜ã€æ‰£åˆ†)
   â”œâ”€ æ€»ä½“åé¦ˆ
   â”œâ”€ æ”¹è¿›å»ºè®®
   â””â”€ çŸ¥è¯†ç‚¹åˆ†æ
   â†“
8. æŸ¥çœ‹å†å²è®°å½•
   â””â”€ æ‰€æœ‰æäº¤çš„æ‰¹æ”¹ç»“æœ
```

---

## ğŸ› ï¸ æŠ€æœ¯å®æ–½ç»†èŠ‚

### åç«¯æ”¹åŠ¨

#### 1. æ•°æ®åº“æ¨¡å‹æ›´æ–°
```python
# app/models/submission.py
class Submission(Base):
    # æ–°å¢å­—æ®µ:
    agent_grading_status: str       # pending/processing/completed/failed
    agent_score: float              # AIè¯„åˆ†
    agent_confidence: float         # ç½®ä¿¡åº¦ (0-1)
    agent_errors: JSON              # é”™è¯¯åˆ—è¡¨
    agent_feedback: Text            # æ€»ä½“åé¦ˆ
    agent_suggestions: JSON         # æ”¹è¿›å»ºè®®
    agent_knowledge_points: JSON    # çŸ¥è¯†ç‚¹åˆ†æ
    agent_processing_time_ms: int   # å¤„ç†æ—¶é—´
    agent_graded_at: DateTime       # æ‰¹æ”¹æ—¶é—´
```

#### 2. WebSocketè¿›åº¦æ¨é€
```python
# è¿›åº¦äº‹ä»¶
{
    "type": "grading_progress",
    "submission_id": "uuid",
    "status": "grading",      # preprocessing/grading/completed/failed
    "progress": 60,           # 0-100
    "message": "æ­£åœ¨æ‰¹æ”¹..."
}
```

#### 3. APIç«¯ç‚¹
```
POST   /v2/grading/submit        # æäº¤æ‰¹æ”¹
GET    /v2/grading/result/{id}   # è·å–ç»“æœ
GET    /v2/grading/status/{id}   # è·å–çŠ¶æ€
GET    /v2/grading/history        # å†å²è®°å½•
DELETE /v2/grading/cancel/{id}   # å–æ¶ˆæ‰¹æ”¹
```

---

### å‰ç«¯æ”¹åŠ¨

#### 1. é¡µé¢ç»“æ„
```
frontend/app/(dashboard)/
â”œâ”€â”€ assignments/[id]/
â”‚   â””â”€â”€ submit/
â”‚       â””â”€â”€ page.tsx          # ä½œä¸šæäº¤é¡µé¢
â””â”€â”€ submissions/
    â”œâ”€â”€ page.tsx              # å†å²è®°å½•é¡µé¢
    â””â”€â”€ [id]/
        â”œâ”€â”€ page.tsx          # æ‰¹æ”¹ç»“æœé¡µé¢
        â””â”€â”€ grading/
            â””â”€â”€ page.tsx      # æ‰¹æ”¹è¿›åº¦é¡µé¢
```

#### 2. æ ¸å¿ƒç»„ä»¶
```typescript
// æ–‡ä»¶ä¸Šä¼ ç»„ä»¶
<FileUpload onChange={setFiles} />

// è¿›åº¦æ¡ç»„ä»¶
<ProgressBar value={progress} />

// åˆ†æ•°å¡ç‰‡
<ScoreCard score={score} confidence={confidence} />

// é”™è¯¯åˆ—è¡¨
<ErrorList errors={errors} />

// åé¦ˆåŒºåŸŸ
<FeedbackSection feedback={feedback} />

// å»ºè®®åˆ—è¡¨
<SuggestionsList suggestions={suggestions} />

// çŸ¥è¯†ç‚¹å›¾è¡¨
<KnowledgePointsChart points={knowledgePoints} />
```

#### 3. APIé›†æˆ
```typescript
// APIå®¢æˆ·ç«¯
const gradingApi = {
  submit: (data) => fetch('/api/v2/grading/submit', ...),
  getResult: (id) => fetch(`/api/v2/grading/result/${id}`, ...),
};

// React Query hooks
const { mutate: submitGrading } = useSubmitGrading();
const { data: result } = useGradingResult(submissionId);

// WebSocket hook
const progress = useGradingProgress(submissionId);
```

---

## âœ… éªŒæ”¶æ ‡å‡†

### åŠŸèƒ½éªŒæ”¶
- [ ] ç”¨æˆ·å¯ä»¥æäº¤ä½œä¸šå¹¶è§¦å‘æ‰¹æ”¹
- [ ] å®æ—¶æ˜¾ç¤ºæ‰¹æ”¹è¿›åº¦ (WebSocket)
- [ ] æ‰¹æ”¹ç»“æœæ­£ç¡®æ˜¾ç¤º
- [ ] æ”¯æŒæŸ¥çœ‹å†å²è®°å½•
- [ ] é”™è¯¯å¤„ç†å®Œå–„
- [ ] æ•°æ®æ­£ç¡®å­˜å‚¨åˆ°æ•°æ®åº“

### æ€§èƒ½éªŒæ”¶
- [ ] æ‰¹æ”¹æ—¶é—´ < 15ç§’
- [ ] APIå“åº”æ—¶é—´ < 500ms
- [ ] WebSocketå»¶è¿Ÿ < 100ms
- [ ] é¡µé¢åŠ è½½æ—¶é—´ < 2ç§’
- [ ] å¹¶å‘10ä¸ªè¯·æ±‚æ— é”™è¯¯

### ç”¨æˆ·ä½“éªŒéªŒæ”¶
- [ ] ç•Œé¢ç¾è§‚
- [ ] äº¤äº’æµç•…
- [ ] åé¦ˆåŠæ—¶
- [ ] é”™è¯¯æç¤ºæ¸…æ™°
- [ ] ç§»åŠ¨ç«¯é€‚é…

---

## ğŸ“ äº¤ä»˜ç‰©æ¸…å•

### åç«¯äº¤ä»˜ç‰©
- [ ] æ•°æ®åº“è¿ç§»æ–‡ä»¶
- [ ] æ›´æ–°çš„Submissionæ¨¡å‹
- [ ] GradingResultServiceæœåŠ¡
- [ ] WebSocketè¿›åº¦æ¨é€
- [ ] å®Œå–„çš„APIç«¯ç‚¹
- [ ] APIæ–‡æ¡£
- [ ] åç«¯æµ‹è¯•è„šæœ¬

### å‰ç«¯äº¤ä»˜ç‰©
- [ ] ä½œä¸šæäº¤é¡µé¢
- [ ] æ‰¹æ”¹è¿›åº¦é¡µé¢
- [ ] æ‰¹æ”¹ç»“æœé¡µé¢
- [ ] å†å²è®°å½•é¡µé¢
- [ ] APIå®¢æˆ·ç«¯
- [ ] React Query hooks
- [ ] WebSocketé›†æˆ
- [ ] UIç»„ä»¶åº“

### æ–‡æ¡£äº¤ä»˜ç‰©
- [ ] Phase 2å®æ–½è®¡åˆ’
- [ ] APIä½¿ç”¨æ–‡æ¡£
- [ ] ç”¨æˆ·ä½¿ç”¨æ‰‹å†Œ
- [ ] å¼€å‘è€…æ–‡æ¡£
- [ ] æµ‹è¯•æŠ¥å‘Š
- [ ] éƒ¨ç½²æ–‡æ¡£

---

## ğŸ“ˆ é¢„æœŸæˆæœ

### åŠŸèƒ½æˆæœ
âœ… å®Œæ•´çš„AIæ‰¹æ”¹åŠŸèƒ½  
âœ… å®æ—¶è¿›åº¦æ˜¾ç¤º  
âœ… å‹å¥½çš„ç”¨æˆ·ç•Œé¢  
âœ… å†å²è®°å½•æŸ¥è¯¢  

### æ€§èƒ½æˆæœ
âœ… æ‰¹æ”¹æ—¶é—´ < 15ç§’  
âœ… å®æ—¶åé¦ˆå»¶è¿Ÿ < 100ms  
âœ… é¡µé¢å“åº”æµç•…  

### ä¸šåŠ¡æˆæœ
âœ… ç”¨æˆ·å¯ä»¥è‡ªåŠ©ä½¿ç”¨AIæ‰¹æ”¹  
âœ… æå‡æ‰¹æ”¹æ•ˆç‡  
âœ… é™ä½äººå·¥æˆæœ¬  
âœ… æä¾›è¯¦ç»†çš„å­¦ä¹ åé¦ˆ  

---

## ğŸ¯ å…³é”®é‡Œç¨‹ç¢‘

### Milestone 1: åç«¯é›†æˆå®Œæˆ (Day 5)
- âœ… æ•°æ®åº“é›†æˆ
- âœ… WebSocketå®æ—¶é€šçŸ¥
- âœ… APIå®Œå–„

### Milestone 2: å‰ç«¯å¼€å‘å®Œæˆ (Day 8)
- âœ… 4ä¸ªé¡µé¢å¼€å‘
- âœ… APIé›†æˆ
- âœ… WebSocketè¿æ¥

### Milestone 3: æµ‹è¯•å®Œæˆ (Day 9)
- âœ… ç«¯åˆ°ç«¯æµ‹è¯•
- âœ… æ€§èƒ½æµ‹è¯•
- âœ… Bugä¿®å¤

### Milestone 4: Phase 2å®Œæˆ (Day 10)
- âœ… ä¼˜åŒ–å®Œæˆ
- âœ… æ–‡æ¡£å®Œå–„
- âœ… éƒ¨ç½²å‡†å¤‡

---

## ğŸš€ ä¸‹ä¸€æ­¥è¡ŒåŠ¨

### ç«‹å³è¡ŒåŠ¨
1. **ç¡®è®¤è®¡åˆ’** - æ‚¨ç¡®è®¤Phase 2è®¡åˆ’
2. **å¼€å§‹å®æ–½** - ä»Day 1å¼€å§‹æ‰§è¡Œ
3. **æ¯æ—¥åŒæ­¥** - æ¯å¤©æ±‡æŠ¥è¿›åº¦

### ç¬¬ä¸€æ­¥ (Day 1)
```bash
# 1. æŸ¥çœ‹ç°æœ‰æ•°æ®åº“æ¨¡å‹
cat backend/app/models/submission.py

# 2. æ£€æŸ¥ç°æœ‰API
cat backend/app/api/v1/grading_v2.py

# 3. æ£€æŸ¥WebSocketå®ç°
cat backend/app/api/websocket.py
```

---

## ğŸ“Š é£é™©è¯„ä¼°

### ä½é£é™©
- âœ… æ•°æ®åº“æ¨¡å‹æ›´æ–° (æ ‡å‡†æ“ä½œ)
- âœ… APIå¼€å‘ (å·²æœ‰æ¡†æ¶)
- âœ… å‰ç«¯é¡µé¢å¼€å‘ (å·²æœ‰ç»„ä»¶åº“)

### ä¸­é£é™©
- âš ï¸ WebSocketé›†æˆ (éœ€è¦æµ‹è¯•ç¨³å®šæ€§)
- âš ï¸ å®æ—¶è¿›åº¦æ¨é€ (éœ€è¦å¤„ç†å¹¶å‘)

### ç¼“è§£æªæ–½
- å……åˆ†æµ‹è¯•WebSocketè¿æ¥
- æ·»åŠ é‡è¿æœºåˆ¶
- æ·»åŠ é™çº§æ–¹æ¡ˆ (è½®è¯¢)

---

## ğŸŠ æ€»ç»“

### Phase 2 æ ¸å¿ƒä»·å€¼
**è®©ç”¨æˆ·çœŸæ­£ç”¨ä¸ŠAIæ‰¹æ”¹åŠŸèƒ½ï¼Œæä¾›å®Œæ•´çš„ç”¨æˆ·ä½“éªŒ**

### å®æ–½ç­–ç•¥
**2å‘¨æ—¶é—´ï¼Œåˆ†æ­¥å®æ–½ï¼Œå‰åç«¯å¹¶è¡Œï¼ŒæŒç»­æµ‹è¯•**

### æˆåŠŸæ ‡å‡†
**ç”¨æˆ·å¯ä»¥æµç•…åœ°æäº¤ä½œä¸šã€æŸ¥çœ‹è¿›åº¦ã€è·å¾—è¯¦ç»†åé¦ˆ**

---

**è®¡åˆ’åˆ¶å®š**: 2025-10-05  
**é¢„è®¡å·¥æœŸ**: 10ä¸ªå·¥ä½œæ—¥  
**å½“å‰çŠ¶æ€**: ğŸ“‹ **è®¡åˆ’å®Œæˆï¼Œç­‰å¾…æ‚¨ç¡®è®¤å¼€å§‹å®æ–½**  

---

## â“ æ‚¨çš„å†³å®š

è¯·ç¡®è®¤ä»¥ä¸‹é—®é¢˜:

1. **æ˜¯å¦åŒæ„è¿™ä¸ªå®æ–½è®¡åˆ’ï¼Ÿ**
2. **æ˜¯å¦ç°åœ¨å¼€å§‹å®æ–½ï¼Ÿ**
3. **æ˜¯å¦æœ‰éœ€è¦è°ƒæ•´çš„åœ°æ–¹ï¼Ÿ**

ç¡®è®¤åï¼Œæˆ‘å°†ç«‹å³å¼€å§‹ **Day 1: æ•°æ®åº“é›†æˆ** çš„å·¥ä½œï¼ğŸš€

