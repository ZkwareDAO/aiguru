# AI智能批改系统 - 完整运行指南

## 项目概述

本项目已成功将原本基于Streamlit的后端替换为FastAPI，并保持了前端"前端"文件夹中的Next.js应用的所有动态效果和现代化UI设计。

## 系统架构

### 后端 (FastAPI)
- **文件**: `app.py` 
- **端口**: 8000
- **功能**: 
  - JWT认证系统
  - 文件上传处理
  - AI批改接口
  - 用户管理
  - 历史记录管理

### 前端 (Next.js)
- **文件夹**: `前端/`
- **端口**: 3000
- **技术栈**: Next.js 15.2.4 + React 19 + TypeScript + Tailwind CSS
- **特色**: 
  - 动态数学符号背景
  - 渐变动画效果
  - 响应式设计
  - 现代化UI组件

## 快速启动

### 🚀 方式一：统一启动器（推荐）

#### PowerShell版本（推荐）
```powershell
# PowerShell中运行（支持彩色输出）
.\start_unified.ps1
```

#### 批处理版本
```bash
# 双击运行或CMD中运行
start_unified.bat

# PowerShell中运行（需要加 .\ 前缀）
.\start_unified.bat
```

**特性**：
- ✅ 自动依赖检查和安装
- ✅ 进程清理防止端口冲突
- ✅ 服务健康检查
- ✅ 自动打开浏览器
- ✅ 友好的用户界面
- ✅ PowerShell版本支持彩色输出

### 📋 方式二：分步启动

#### 1. 启动后端服务

```bash
# 方式一：使用uvicorn命令（无警告）
uvicorn app:app --host 0.0.0.0 --port 8000 --reload

# 方式二：直接运行Python文件
python app.py

# 方式三：使用简化启动脚本
start_simple.bat
```

后端将在 http://localhost:8000 启动

#### 2. 启动前端服务

```bash
# 进入前端目录
cd 前端

# 安装依赖（首次运行）
npm install

# 启动开发服务器
npm run dev
```

前端将在 http://localhost:3000 启动

### 🌐 访问应用

打开浏览器访问: http://localhost:3000

## 功能特性

### 已实现的核心功能

1. **用户认证系统**
   - 登录/注册页面 (`/auth`)
   - JWT token管理
   - 测试账户：`test_user_1` / `password1`

2. **AI智能批改**
   - 文件上传界面 (`/grading`)
   - 支持题目、评分标准、学生作答文件
   - 实时进度显示
   - 与后端API完整集成

3. **精美的UI设计**
   - 动态数学符号背景
   - 渐变色彩主题
   - 悬停动画效果
   - 响应式布局

4. **用户体验优化**
   - 智能导航栏（根据登录状态变化）
   - 错误处理和反馈
   - Loading状态管理

### 保持的原有功能

- 完整的AI批改逻辑（来自`functions.api_correcting.calling_api`）
- 用户数据持久化
- 文件上传和管理
- 错误日志记录

## API接口文档

### 认证接口

- `POST /api/auth/login` - 用户登录
- `POST /api/auth/register` - 用户注册

### 批改接口

- `POST /api/correction/upload` - 上传文件进行批改
- `GET /api/user/records` - 获取用户历史记录

### 系统接口

- `GET /health` - 健康检查

## 测试账户

系统预置了测试账户方便测试：

- 用户名: `test_user_1`
- 密码: `password1`

- 用户名: `test_user_2` 
- 密码: `password2`

## 项目结构

```
.
├── app.py                 # FastAPI后端服务
├── main.py               # 原Streamlit应用（已替换）
├── functions/            # AI批改功能模块
├── 前端/                 # Next.js前端应用
│   ├── app/             # Next.js应用页面
│   │   ├── page.tsx     # 首页（动态效果）
│   │   ├── grading/     # 批改页面
│   │   └── auth/        # 认证页面
│   ├── components/      # React组件
│   │   ├── ui/          # UI组件库
│   │   ├── auth/        # 认证组件
│   │   └── header.tsx   # 导航栏
│   └── lib/
│       └── api.ts       # API服务层
├── user_data.json       # 用户数据存储
└── uploads/             # 文件上传目录
```

## 开发说明

### 前端开发

- 组件使用Radix UI + Tailwind CSS
- 状态管理使用React hooks
- API调用通过`lib/api.ts`统一管理
- 支持TypeScript类型检查

### 后端开发

- 基于FastAPI框架
- JWT认证中间件
- CORS配置支持前端跨域
- 文件上传大小限制5MB
- 集成原有AI批改功能

## 故障排除

### 常见问题

1. **后端无法启动**
   - 检查端口8000是否被占用
   - 确认Python依赖已安装: `pip install -r requirements.txt`

2. **前端无法连接后端**
   - 确认后端服务已启动 (http://localhost:8000)
   - 检查CORS配置是否正确

3. **文件上传失败**
   - 检查文件大小是否超过5MB限制
   - 确认`uploads/`目录存在且可写

4. **TypeScript错误**
   - 在前端目录运行: `npm install`
   - 确认所有依赖已正确安装

### 日志查看

- 后端日志: 在运行`python app.py`的终端中查看
- 前端日志: 在浏览器开发者工具Console中查看

## 下一步扩展

可以进一步添加的功能：

1. **用户管理**
   - 用户资料页面
   - 密码修改功能
   - 头像上传

2. **批改历史**
   - 历史记录页面
   - 结果下载功能
   - 批改报告生成

3. **系统优化**
   - 数据库集成（替换JSON文件）
   - 缓存机制
   - 性能监控

4. **部署配置**
   - Docker容器化
   - 生产环境配置
   - CI/CD流水线

## 技术支持

如遇到问题，请检查：

1. 所有依赖是否正确安装
2. 端口是否正确配置
3. 文件权限是否正确设置
4. 网络连接是否正常

成功替换完成！现在您拥有一个现代化的、功能完整的AI智能批改系统。 